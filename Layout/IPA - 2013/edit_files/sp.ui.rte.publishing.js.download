function ULS7Bo(){var o=new Object;o.ULSTeamName="CMS";o.ULSFileName="SP.UI.Rte.Publishing.js";return o;}
if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["sp.ui.rte.publishing.js"]={version:{rmj:16,rmm:0,rup:6119,rpr:1207}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_sp.ui.rte.publishing.js");Type.registerNamespace("RTE");RTE.PublishingCanvas=function(){ULS7Bo:;RTE.PublishingCanvas.initializeBase(this)};RTE.PublishingCanvas.loadPublishing=function(){ULS7Bo:;RTE.CanvasEvents.registerListener("EditableRegionBlur",RTE.PublishingRichTextEditor.onRteBlur);RTE.CanvasEvents.registerListener("EditableRegionFocus",RTE.PublishingRichTextEditor.onRteFocus);var a=new RTE.PublishingRichTextEditorComponentProvider;if(RTE.CleanPasteMode.passThroughClasses)RTE.CleanPasteMode.passThroughClasses[RTE.CleanPasteMode.passThroughClasses.length]="ms-reusableTextView";RTE.RichTextEditorComponentProvider.register(a)};RTE.PublishingCanvas.registerImageField=function(b){ULS7Bo:;var a=$get(b);if(a){RTE.PublishingRichTextEditor.makeEditableBorder(a);$addHandler(a,"keydown",RTE.PublishingCanvas.$1Y);$addHandler(a,"cut",RTE.PublishingCanvas.$3);$addHandler(a,"paste",RTE.PublishingCanvas.$3);RTE.PublishingCanvas.$q(a)}};RTE.PublishingCanvas.$q=function(a){ULS7Bo:;if(a){$addHandler(a,"dragstart",RTE.PublishingCanvas.$3);$addHandler(a,"drag",RTE.PublishingCanvas.$3);$addHandler(a,"dragenter",RTE.PublishingCanvas.$3);$addHandler(a,"dragover",RTE.PublishingCanvas.$3);$addHandler(a,"drop",RTE.PublishingCanvas.$3)}};RTE.PublishingCanvas.$3=function(a){ULS7Bo:;SP.UI.UIUtility.cancelEvent(a);return false};RTE.PublishingCanvas.$1Y=function(a){ULS7Bo:;RTE.PublishingCanvas.$1Z(a,"IMG")};RTE.PublishingCanvas.$1Z=function(a,c){ULS7Bo:;if(a.keyCode===8||a.keyCode===127){var b=RTE.Canvas.getEditableRegion(a.target);if(!b)return;window.setTimeout(function(){ULS7Bo:;!b.getElementsByTagName(c).length&&RTE.Canvas.showEmptyPanel(b)},0)}else if(a.keyCode===39||a.keyCode===37){RTE.PublishingCanvas.$3(a);return false}};RTE.PublishingCommandNames=function(){};RTE.PublishingRibbonIds=function(){};RTE.PublishingRichTextEditor=function(){ULS7Bo:;RTE.PublishingRichTextEditor.initializeBase(this)};RTE.PublishingRichTextEditor.setLinkName=function(b){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.getAttribute("name")!==b||a.getAttribute("id")!==b);a.setAttribute("name",b);a.setAttribute("id",b);RTE.SnapshotManager.takeSnapshot()};RTE.PublishingRichTextEditor.getLinkName=function(){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");return a?RTE.RteUtility.getAttribute(a,"name"):null};RTE.PublishingRichTextEditor.insertOrEditSharepointLink=function(){ULS7Bo:;RTE.SnapshotManager.takeSnapshot();var c=RTE.Cursor.get_range(),b=c.getEditableRegion();if(!b)return;var e=b.id,f=RTE.Canvas.getProperty(b,"DefaultAssetLocation"),g=RTE.Canvas.getProperty(b,"DefaultAssetImageLocation"),h=RTE.Canvas.getProperty(b,"CurrentWebBaseUrl"),i=!RTE.Canvas.getBooleanProperty(b,"RestrictUrlsToSiteCollection"),a=RTE.CanvasEvents.getNodeFromEvent("Link"),d=false;if(!a){d=true;a=document.createElement("A")}SP.SOD.executeFunc("AssetPickers.js","AssetPickerConfig",function(){ULS7Bo:;var b=a.href;RTE.Common.insertOrChangeHyperLink(e,f,g,h,i,a,function(e,g){ULS7Bo:;if(RTE.PSU.$G(e))return;if(d){c.wrapRange(a);var f=a.getElementsByTagName("IMG"),h=!RTE.PSU.$A(a.innerText)?a.innerText:a.textContent;if(h===""&&(!f||!f.length)){var i=a.ownerDocument.createTextNode(g);a.appendChild(i)}}RTE.SnapshotManager.setCurrentRegionDirtyIf(RTE.PSU.$G(b)||b!==e);c.moveAfterNode(a);RTE.RteUtility.fixLinkHierarchy&&RTE.RteUtility.fixLinkHierarchy(a);RTE.Cursor.update();RTE.SnapshotManager.takeSnapshot()})})};RTE.PublishingRichTextEditor.insertOrEditImage=function(){ULS7Bo:;RTE.SnapshotManager.takeSnapshot();var d=RTE.Cursor.get_range(),b=d.getEditableRegion();if(!b)return;var e=b.id,f=RTE.Canvas.getProperty(b,"DefaultAssetLocation"),g=RTE.Canvas.getProperty(b,"DefaultAssetImageLocation"),h=RTE.Canvas.getProperty(b,"CurrentWebBaseUrl"),i=!RTE.Canvas.getBooleanProperty(b,"RestrictUrlsToSiteCollection"),a=RTE.CanvasEvents.getNodeFromEvent("Image"),c=false;if(!a){c=true;a=document.createElement("IMG");RTE.RteUtility.initImage(a)}SP.SOD.executeFunc("AssetPickers.js","AssetPickerConfig",function(){ULS7Bo:;var b=RTE.ImageRenditionCommands.getSourceUrlOnly(a.src);RTE.Common.insertOrChangeImage(e,f,g,h,i,a,function(){ULS7Bo:;a.src=RTE.ImageRenditionCommands.addRenditionInfoToImageSrc(a.src);if(c&&!RTE.PSU.$G(a.src)){RTE.Cursor.get_range().deleteContent();RTE.Cursor.get_range().insertNode(a)}RTE.SnapshotManager.setCurrentRegionDirtyIf(RTE.PSU.$G(b)||a.src!==b);RTE.Cursor.update();RTE.SnapshotManager.takeSnapshot();RTE.SpRteUtility.showRibbonTab("Ribbon.Image","ImageTab")})})};RTE.PublishingRichTextEditor.setImageHorizontalSpace=function(b){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.marginLeft!==b||a.style.marginRight!==b);a.style.marginLeft=b;a.style.marginRight=b;RTE.SnapshotManager.takeSnapshot()};RTE.PublishingRichTextEditor.setImageVerticalSpace=function(b){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.marginTop!==b||a.style.marginBottom!==b);a.style.marginTop=b;a.style.marginBottom=b;RTE.SnapshotManager.takeSnapshot()};RTE.PublishingRichTextEditor.transferContents=function(b){ULS7Bo:;var a=$get(b);RTE.RteUtility.assertNotNull("editableRegion",a);RTE.PublishingRichTextEditor.transferContentsOfEditableRegion(a)};RTE.PublishingRichTextEditor.transferContentsOfEditableRegion=function(a){ULS7Bo:;RTE.RteUtility.assertNotNull("editableRegion",a);RTE.RichTextEditor.transferContentsToInputFieldNode(a,true);var b=RTE.RteUtility.getAttribute(a,"StorageFieldId");if(!b)return;var c=$get(b);if(c){var d=RTE.ReusableContent.getEditableRegionStorageHtml(a);RTE.RteUtility.setInputValue(c,d)}};RTE.PublishingRichTextEditor.replaceContent=function(b,c){ULS7Bo:;var a=$get(b);RTE.RteUtility.assertNotNull("editableRegion",a);a.innerHTML=c;RTE.PublishingRichTextEditor.transferContentsOfEditableRegion(a)};RTE.PublishingRichTextEditor.hideValidationError=function(b){ULS7Bo:;var a=$get(b);RTE.RteUtility.assertNotNull("editableRegion",a);var c=RTE.RteUtility.getAttribute(a,"StorageFieldId");!c};RTE.PublishingRichTextEditor.onLoad=function(b){ULS7Bo:;RTE.RteUtility.assertNotNull("editableRegionId",b);var a=$get(b);RTE.RteUtility.assertNotNull("editableRegion",a);RTE.Canvas.restoreViewHtml(a);RTE.PublishingRichTextEditor.$1U(a)};RTE.PublishingRichTextEditor.$1U=function(a){ULS7Bo:;RTE.Canvas.makeRegionEditable(a);RTE.PublishingRichTextEditor.makeEditableBorder(a);var c=RTE.Canvas.getProperty(a,"EmptyPanelId");if(!RTE.PSU.$G(c)){var g=$get(c);RTE.Canvas.setRedirectOnNode(g,a.id)}if(!a.style.minHeight&&RTE.RteUtility.isFirefox())a.style.minHeight="18px";!RTE.Canvas.getCachedRestriction(a,"AllowDragDrop",true)&&RTE.PublishingCanvas.$q(a);RTE.PublishingRichTextEditor.$1X(a);var d=true;d=RTE.UiServices.get_current().initialFocusOnRichText();if(d){var b=RTE.SnapshotManager.getMarkers();if(!RTE.PublishingRichTextEditor.$I&&b.length===2&&b[0]&&b[1]){RTE.Cursor.get_range().setMarkersCollection(b);var e=RTE.Cursor.get_range().getEditableRegion();e&&RTE.RteUtility.focusNoFail(e);RTE.Cursor.update();RTE.PublishingRichTextEditor.$I=true;RTE.PublishingRichTextEditor.$O=true}else{var f=RTE.Canvas.getProperty(a,"HasInitialFocus");if(f&&f&&!RTE.PublishingRichTextEditor.$O){RTE.PublishingRichTextEditor.$t(a);RTE.PublishingRichTextEditor.$O=true}else!RTE.PublishingRichTextEditor.$I&&RTE.PublishingRichTextEditor.$t(a)}}};RTE.PublishingRichTextEditor.$1X=function(d){ULS7Bo:;var a=d;while(a){if(a.className)if(a.className.indexOf("ms-formfieldcontainer")!==-1){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];c.className&&c.className.indexOf("ms-formfieldlabelcontainer")!==-1&&RTE.Canvas.setRedirectOnNode(a,d.id)}return}a=a.parentNode}};RTE.PublishingRichTextEditor.$t=function(a){ULS7Bo:;RTE.RteUtility.focusNoFail(a);RTE.Cursor.get_range().moveToStartOfNode(a);RTE.Cursor.update();RTE.PublishingRichTextEditor.$I=true};RTE.PublishingRichTextEditor.$1W=function(c){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;var b=a.style.marginTop;if(b===""&&a.currentStyle)b=a.currentStyle.marginTop;RTE.SpRteUtility.parseStringForSpinnerControl(b,c,0,"px")};RTE.PublishingRichTextEditor.$1V=function(c){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;var b=a.style.marginLeft;if(b===""&&a.currentStyle)b=a.currentStyle.marginLeft;RTE.SpRteUtility.parseStringForSpinnerControl(b,c,0,"px")};RTE.PublishingRichTextEditor.removeActive=function(a){ULS7Bo:;while(a){if(a.className)if(a.className.indexOf("ms-formfieldvaluecontainer")!==-1){Sys.UI.DomElement.removeCssClass(a,"ms-rte-border");return}a=a.parentNode}};RTE.PublishingRichTextEditor.addActive=function(a){ULS7Bo:;while(a){if(a.className)if(a.className.indexOf("ms-formfieldvaluecontainer")!==-1){Sys.UI.DomElement.addCssClass(a,"ms-rte-border");return}a=a.parentNode}};RTE.PublishingRichTextEditor.makeEditableBorder=function(a){ULS7Bo:;while(a){if(a.className)if(a.className.indexOf("ms-formfieldvaluecontainer")!==-1){Sys.UI.DomElement.addCssClass(a,"ms-rte-border-field");return}a=a.parentNode}};RTE.PublishingRichTextEditor.onRteBlur=function(c,b){ULS7Bo:;var a=b.oldEditableRegion;RTE.PublishingRichTextEditor.removeActive(a)};RTE.PublishingRichTextEditor.onRteFocus=function(c,b){ULS7Bo:;var a=b.newEditableRegion;RTE.PublishingRichTextEditor.addActive(a)};RTE.PublishingRichTextEditor.$u=function(){ULS7Bo:;RTE.Imports.ExecuteOrDelayUntilScriptLoaded(function(){ULS7Bo:;if(window.SP&&window.SP.Ribbon){var a=SP.Ribbon.PageManager.get_instance();a&&a.get_commandDispatcher().executeCommand("appstatechanged",null)}},"sp.ribbon.js")};RTE.PublishingRichTextEditorComponentProvider=function(){ULS7Bo:;this.$$d_$1A_1=Function.createDelegate(this,this.$1A_1);this.$$d_$16_1=Function.createDelegate(this,this.$16_1);RTE.PublishingRichTextEditorComponentProvider.initializeBase(this)};RTE.PublishingRichTextEditorComponentProvider.$1N=function(){ULS7Bo:;if(RTE.Externals.imageRenditions&&RTE.Externals.imageRenditions.Renditions.length>0){var a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.Image.Image.Renditions.PickRendition.Menu'>");a.append("<MenuSection Id='Ribbon.Image.Image.Renditions.PickRendition.Menu.Renditions'>");a.append("<Controls Id='Ribbon.Image.Image.Renditions.PickRendition.Menu.Renditions.Controls'>");for(var b=0;b<RTE.Externals.imageRenditions.Renditions.length;b++){a.append("<Button");a.append(" id='Ribbon.Image.Image.Renditions.PickRendition.Menu.Rendition.Item");a.append(RTE.Externals.imageRenditions.Renditions[b].Id.toString());a.append("' LabelText='");a.append(SP.Utilities.HttpUtility.escapeXmlText(RTE.Externals.imageRenditions.Renditions[b].Name));a.append("' CommandType='General' MenuItemId='Rendition");a.append(RTE.Externals.imageRenditions.Renditions[b].Id.toString());a.append("' CommandValueId='");a.append(RTE.Externals.imageRenditions.Renditions[b].Id.toString());a.append("' Command='");a.append("PickImageRenditionClick");a.append("' />")}a.append("</Controls></MenuSection>");a.append("<MenuSection Id='Ribbon.Image.Image.Renditions.PickRendition.Menu.EditRenditions'>");a.append("<Controls Id='Ribbon.Image.Image.Renditions.PickRendition.Menu.EditRenditions.Controls'>");a.append("<Button");a.append(" id='Ribbon.Image.Image.Renditions.PickRendition.Menu.EditRendition.Edit' LabelText='");a.append(SP.Utilities.HttpUtility.escapeXmlText(SP.Publishing.Resources.editImageRenditions));a.append("' CommandType='General' MenuItemId='EditRendition' Command='");a.append("EditImageRenditionClick");a.append("' />");a.append("</Controls></MenuSection>");a.append("</Menu>");return a.toString()}return""};RTE.PublishingRichTextEditorComponentProvider.$1O=function(){ULS7Bo:;if(RTE.ReusableItems.items){var a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.EditingTools.CPInsert.Content.ReusableContent.Menu'>");a.append("<MenuSection Id='Ribbon.EditingTools.CPInsert.Content.ReusableContent.Menu.ReusableContent'>");a.append("<Controls Id='Ribbon.EditingTools.CPInsert.Content.ReusableContent.Menu.ReusableContent.Controls'>");for(var b=0;b<RTE.ReusableItems.items.length;b++){a.append("<Button");a.append(" id='Ribbon.EditingTools.CPInsert.Content.ReusableContent.Menu.ReusableContent.Item");a.append(b.toString());a.append("' LabelText='");a.append(SP.Utilities.HttpUtility.escapeXmlText(RTE.ReusableItems.items[b].title));a.append("' CommandType='General' MenuItemId='");a.append("fseaReusableItem"+b.toString());a.append("' CommandValueId='");a.append(b.toString());a.append("' Command='");a.append("ReusableItemClick");a.append("' CommandPreview='");a.append("ReusableItemPreview");a.append("' CommandRevert='");a.append("ReusableItemRevert");a.append("' />")}a.append("<Button");a.append(" id='Ribbon.EditingTools.CPInsert.Content.ReusableContent.Menu.ReusableContent.Dialog' LabelText='");a.append(SP.Utilities.HttpUtility.escapeXmlText(SP.Publishing.Resources.labelMoreChoice));a.append("' CommandType='General'");a.append(" Command='");a.append("ReusablePopup");a.append("' />");a.append("</Controls></MenuSection></Menu>");return a.toString()}return""};RTE.PublishingRichTextEditorComponentProvider.$1P=function(){ULS7Bo:;var a=window.WPAdder;if(!a){window.LoadWPAdderOnDemand();return}if(a){a.selectCategoryByTitle(SP.Utilities.HttpUtility.escapeXmlText(SP.Publishing.Resources.socialPlugin));a._showCategoryColumn(false);a.show()}};RTE.PublishingRichTextEditorComponentProvider.$k=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$D(a)&&!!RTE.Externals.imageRenditions&&RTE.ImageRenditionCommands.canChangeRendition(a)};RTE.PublishingRichTextEditorComponentProvider.$L=function(){ULS7Bo:;return!!RTE.Externals.rca&&RTE.Externals.rca.enabled};RTE.PublishingRichTextEditorComponentProvider.$10=function(){ULS7Bo:;return!!RTE.Externals.rca&&RTE.Externals.rca.enabled&&RTE.Externals.rca.pageWritable};RTE.PublishingRichTextEditorComponentProvider.$n=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowReusableContent",false)};RTE.PublishingRichTextEditorComponentProvider.$w=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowHtmlSourceEditing",true)};RTE.PublishingRichTextEditorComponentProvider.$z=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowInsert",true)};RTE.PublishingRichTextEditorComponentProvider.$l=function(a){ULS7Bo:;return!RTE.Canvas.getCachedRestriction(a,"AllowOnlyInsertLink",false)};RTE.PublishingRichTextEditorComponentProvider.$h=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowEmbedding",true)};RTE.PublishingRichTextEditorComponentProvider.$D=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowImages",true)};RTE.PublishingRichTextEditorComponentProvider.$T=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$D(a)&&RTE.Canvas.getCachedRestriction(a,"AllowImageFormatting",true)};RTE.PublishingRichTextEditorComponentProvider.$y=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$M(a)&&RTE.PublishingRichTextEditorComponentProvider.$T(a)&&RTE.Canvas.getCachedRestriction(a,"AllowImageStyles",true)};RTE.PublishingRichTextEditorComponentProvider.$x=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$T(a)&&RTE.Canvas.getCachedRestriction(a,"AllowImagePositioning",true)};RTE.PublishingRichTextEditorComponentProvider.$i=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowFonts",true)&&!RTE.Canvas.getCachedRestriction(a,"DisableBasicFormattingButtons",false)};RTE.PublishingRichTextEditorComponentProvider.$j=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$i(a)&&RTE.Canvas.getCachedRestriction(a,"AllowFontsMenu",true)};RTE.PublishingRichTextEditorComponentProvider.$J=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$j(a)&&RTE.Canvas.getCachedRestriction(a,"AllowFontSizesMenu",true)};RTE.PublishingRichTextEditorComponentProvider.$W=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$J(a)&&RTE.Canvas.getCachedRestriction(a,"AllowFontStandardSizes",true)};RTE.PublishingRichTextEditorComponentProvider.$C=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$j(a)};RTE.PublishingRichTextEditorComponentProvider.$Y=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$C(a)&&RTE.Canvas.getCachedRestriction(a,"AllowThemeFonts",true)};RTE.PublishingRichTextEditorComponentProvider.$V=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$C(a)&&RTE.Canvas.getCachedRestriction(a,"AllowStandardFonts",true)};RTE.PublishingRichTextEditorComponentProvider.$6=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$M(a)&&RTE.Canvas.getCachedRestriction(a,"AllowHeadings",true)};RTE.PublishingRichTextEditorComponentProvider.$K=function(c){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(a)return false;var b=RTE.CanvasEvents.getNodeFromEvent("Atomic");return b?false:RTE.PublishingRichTextEditorComponentProvider.$U(c)};RTE.PublishingRichTextEditorComponentProvider.$U=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowHyperlinks",true)};RTE.PublishingRichTextEditorComponentProvider.$m=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowLists",true)};RTE.PublishingRichTextEditorComponentProvider.$X=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowTables",true)};RTE.PublishingRichTextEditorComponentProvider.$M=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowStyles",true)};RTE.PublishingRichTextEditorComponentProvider.$11=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$X(a)&&RTE.PublishingRichTextEditorComponentProvider.$l(a)&&RTE.PublishingRichTextEditorComponentProvider.$M(a)&&RTE.Canvas.getCachedRestriction(a,"AllowTableStyles",true)};RTE.PublishingRichTextEditorComponentProvider.$N=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$M(a)&&!RTE.Canvas.getCachedRestriction(a,"DisableCustomStyles",false)};RTE.PublishingRichTextEditorComponentProvider.$o=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$6(a)||RTE.PublishingRichTextEditorComponentProvider.$N(a)};RTE.PublishingRichTextEditorComponentProvider.$4=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowFontColorsMenu",true)&&!RTE.Canvas.getCachedRestriction(a,"DisableBasicFormattingButtons",false)};RTE.PublishingRichTextEditorComponentProvider.$g=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$4(a)&&RTE.Canvas.getCachedRestriction(a,"AllowFontCustomColors",true)};RTE.PublishingRichTextEditorComponentProvider.$8=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$4(a)&&RTE.Canvas.getCachedRestriction(a,"AllowFontStandardColors",true)};RTE.PublishingRichTextEditorComponentProvider.$9=function(a){ULS7Bo:;return RTE.PublishingRichTextEditorComponentProvider.$4(a)&&RTE.Canvas.getCachedRestriction(a,"AllowFontThemeColors",true)};RTE.PublishingRichTextEditorComponentProvider.$7=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowParagraphFormatting",true)&&!RTE.Canvas.getCachedRestriction(a,"DisableBasicFormattingButtons",false)};RTE.PublishingRichTextEditorComponentProvider.$5=function(a){ULS7Bo:;return RTE.Canvas.getCachedRestriction(a,"AllowTextMarkup",true)&&!RTE.Canvas.getCachedRestriction(a,"DisableBasicFormattingButtons",false)};RTE.PublishingRichTextEditorComponentProvider.$12=function(c,b){ULS7Bo:;var a=parseInt(b.CommandValueId);RTE.ImageRenditionCommands.changeImageRendition(a);return true};RTE.PublishingRichTextEditorComponentProvider.$13=function(){ULS7Bo:;RTE.ImageRenditionCommands.editImageRenditions();return true};RTE.PublishingRichTextEditorComponentProvider.$15=function(c,b){ULS7Bo:;var a=b;a.PopulationXML=RTE.PublishingRichTextEditorComponentProvider.$1N();return true};RTE.PublishingRichTextEditorComponentProvider.$1G=function(c,b){ULS7Bo:;var a=b;a.PopulationXML=RTE.PublishingRichTextEditorComponentProvider.$1O();return true};RTE.PublishingRichTextEditorComponentProvider.$1J=function(){ULS7Bo:;RTE.PublishingRichTextEditorComponentProvider.$1P();return true};RTE.PublishingRichTextEditorComponentProvider.$p=function(){ULS7Bo:;RTE.PublishingRichTextEditor.insertOrEditSharepointLink();return true};RTE.PublishingRichTextEditorComponentProvider.$a=function(){ULS7Bo:;RTE.PublishingRichTextEditor.insertOrEditImage();return true};RTE.PublishingRichTextEditorComponentProvider.$14=function(c,b){ULS7Bo:;var a=RTE.SpRteUtility.getStringValueFromSpinnerControlProperties(b);RTE.PublishingRichTextEditor.setImageHorizontalSpace(a);return true};RTE.PublishingRichTextEditorComponentProvider.$17=function(c,b){ULS7Bo:;var a=RTE.SpRteUtility.getStringValueFromSpinnerControlProperties(b);RTE.PublishingRichTextEditor.setImageVerticalSpace(a);return true};RTE.PublishingRichTextEditorComponentProvider.$18=function(b,a){ULS7Bo:;RTE.RteUtility.classMustExist("CUI.Controls.TextBoxCommandProperties");RTE.PublishingRichTextEditor.setLinkName(a.Value);return true};RTE.PublishingRichTextEditorComponentProvider.$1C=function(c,b){ULS7Bo:;RTE.RteUtility.classMustExist("CUI.Controls.TextBoxCommandProperties");var a=RTE.PublishingRichTextEditor.getLinkName();if(!RTE.PSU.$A(a))b.Value=a;else b.Value="";return true};RTE.PublishingRichTextEditorComponentProvider.$19=function(b,a){ULS7Bo:;RTE.PublishingRichTextEditor.$1V(a);return true};RTE.PublishingRichTextEditorComponentProvider.$1B=function(b,a){ULS7Bo:;RTE.PublishingRichTextEditor.$1W(a);return true};RTE.PublishingRichTextEditorComponentProvider.$1H=function(){ULS7Bo:;RTE.PreviewManager.get_instance().beginPreview();RTE.PublishingRichTextEditorComponentProvider.$H=-1;return true};RTE.PublishingRichTextEditorComponentProvider.$1F=function(){ULS7Bo:;RTE.PreviewManager.get_instance().endPreview();RTE.PublishingRichTextEditorComponentProvider.$H=-1;return true};RTE.PublishingRichTextEditorComponentProvider.$Z=function(b,d){ULS7Bo:;var a=parseInt(d.CommandValueId);if(b==="ReusableItemPreview"||b==="ReusableItemClick")if(RTE.PublishingRichTextEditorComponentProvider.$H!==a){RTE.PreviewManager.get_instance().restoreBeginState();var c=RTE.ReusableItems.items[a];RTE.ReusableContent.insertReusableItem(c);RTE.PreviewManager.get_instance().commitCommandOrAfterPreview(!!RTE.SpRteUtility.commandTypeFromCommandName(b));RTE.PublishingRichTextEditorComponentProvider.$H=a}return true};RTE.PublishingRichTextEditorComponentProvider.$1I=function(){ULS7Bo:;RTE.ReusableContent.insertReusableItemFromDialog();return true};RTE.PublishingRichTextEditorComponentProvider.$1D=function(){ULS7Bo:;RTE.Rca.openSourceDocument();return true};RTE.PublishingRichTextEditorComponentProvider.$1E=function(){ULS7Bo:;RTE.Rca.updateFromSourceDocument();return true};RTE.PublishingRichTextEditorComponentProvider.prototype={$2_1:null,$E_1:null,$1_1:null,$0_1:null,init:function(a){ULS7Bo:;this.$2_1=a;this.$E_1=["ChangeLinkMenuOpen","ChangeLinkMenuClose","InsertLinkSharepoint","InsertImageSharepoint","ImageHorizontalSpace","ImageVerticalSpace","LinkBookmark","QueryImageHorizontalSpace","QueryImageVerticalSpace","ReusableItemClick","ReusableItemPreview","ReusableItemRevert","ReusablePopup","ContentGroup","ReusableMenu","ReusableMenuClose","GetReusableContentMenuXml","GetSocialPluginMenuXml","ImageSpacing","RcaOpenSource","RcaUpdateDocument","RcaContextualGroup","RcaTab","RcaViewUpdateGroup","LinkEditSharepoint","LinkBookmarkLabel","ImageHorizontalSpaceLabel","ImageVerticalSpaceLabel","PickImageRendition","PickImageRenditionClick","EditImageRenditionClick","GetImageRenditionsMenuXml"]},canHandleCommand:function(b){ULS7Bo:;var a=RTE.Canvas.currentEditableRegion();if(!a)return false;if(RTE.Canvas.getCachedRestriction(a,"DisableRibbonCommands",false))return false;this.initializeCanHandleHandlerDictionary();var c=this.$0_1[b];if(!RTE.PSU.$A(c)){var d=c;if(!d(a))return false}return Array.indexOf(this.$E_1,b)>=0?true:this.$2_1?this.$2_1.canHandleCommand(b):false},initializeCanHandleHandlerDictionary:function(){ULS7Bo:;if(!RTE.PSU.$A(this.$0_1))return;this.$0_1={};this.$0_1.RcaContextualGroup=RTE.PublishingRichTextEditorComponentProvider.$L;this.$0_1.RcaTab=RTE.PublishingRichTextEditorComponentProvider.$L;this.$0_1.RcaViewUpdateGroup=RTE.PublishingRichTextEditorComponentProvider.$L;this.$0_1.RcaOpenSource=RTE.PublishingRichTextEditorComponentProvider.$L;this.$0_1.RcaUpdateDocument=RTE.PublishingRichTextEditorComponentProvider.$10;this.$0_1.ReusableMenu=RTE.PublishingRichTextEditorComponentProvider.$n;this.$0_1.ReusableMenuClose=RTE.PublishingRichTextEditorComponentProvider.$n;this.$0_1.EditSource=RTE.PublishingRichTextEditorComponentProvider.$w;this.$0_1.InsertTab=RTE.PublishingRichTextEditorComponentProvider.$z;this.$0_1.PickImageRendition=RTE.PublishingRichTextEditorComponentProvider.$k;this.$0_1.PickImageRenditionClick=RTE.PublishingRichTextEditorComponentProvider.$k;this.$0_1.InsertDocumentOptions=RTE.PublishingRichTextEditorComponentProvider.$l;this.$0_1.InsertImage=RTE.PublishingRichTextEditorComponentProvider.$D;this.$0_1.InsertImageMenuOpen=RTE.PublishingRichTextEditorComponentProvider.$D;this.$0_1.ImageContextualGroup=RTE.PublishingRichTextEditorComponentProvider.$D;this.$0_1.ImageStyleGroup=RTE.PublishingRichTextEditorComponentProvider.$y;this.$0_1.ImageArrangeGroup=RTE.PublishingRichTextEditorComponentProvider.$x;this.$0_1.ImageSpacing=RTE.PublishingRichTextEditorComponentProvider.$T;this.$0_1.FontGroup=RTE.PublishingRichTextEditorComponentProvider.$i;this.$0_1.SelectFont=RTE.PublishingRichTextEditorComponentProvider.$C;this.$0_1.FontFamilyStyleOpen=RTE.PublishingRichTextEditorComponentProvider.$C;this.$0_1.FontFamilyStyleValue=RTE.PublishingRichTextEditorComponentProvider.$C;this.$0_1.SelectFontSize=RTE.PublishingRichTextEditorComponentProvider.$J;this.$0_1.FontSizeStyleOpen=RTE.PublishingRichTextEditorComponentProvider.$J;this.$0_1.FontSizeStyleValue=RTE.PublishingRichTextEditorComponentProvider.$J;this.$0_1.FontFamilyCssClass=RTE.PublishingRichTextEditorComponentProvider.$V;this.$0_1.FontFamilyCssClassPreview=RTE.PublishingRichTextEditorComponentProvider.$V;this.$0_1.FontFamilyCssClassPreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$V;this.$0_1.FontFamilyThemeClass=RTE.PublishingRichTextEditorComponentProvider.$Y;this.$0_1.FontFamilyThemeClassPreview=RTE.PublishingRichTextEditorComponentProvider.$Y;this.$0_1.FontFamilyThemeClassPreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$Y;this.$0_1.FontSizeCssClass=RTE.PublishingRichTextEditorComponentProvider.$W;this.$0_1.FontSizeCssClassPreview=RTE.PublishingRichTextEditorComponentProvider.$W;this.$0_1.FontSizeCssClassPreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$W;this.$0_1.ElementWithStyle=RTE.PublishingRichTextEditorComponentProvider.$6;this.$0_1.ElementWithStylePreview=RTE.PublishingRichTextEditorComponentProvider.$6;this.$0_1.ElementWithStylePreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$6;this.$0_1.ElementWithStyleOptions=RTE.PublishingRichTextEditorComponentProvider.$6;this.$0_1.ElementWithStyleOptionsOpen=RTE.PublishingRichTextEditorComponentProvider.$6;this.$0_1.InsertLinkSharepoint=RTE.PublishingRichTextEditorComponentProvider.$K;this.$0_1.UploadDocumentRTE=RTE.PublishingRichTextEditorComponentProvider.$U;this.$0_1.InsertLink=RTE.PublishingRichTextEditorComponentProvider.$K;this.$0_1.InsertLinkMenuOpen=RTE.PublishingRichTextEditorComponentProvider.$K;this.$0_1.InsertLinkWeb=RTE.PublishingRichTextEditorComponentProvider.$K;this.$0_1.LinkContextualGroup=RTE.PublishingRichTextEditorComponentProvider.$U;this.$0_1.BulletedList=RTE.PublishingRichTextEditorComponentProvider.$m;this.$0_1.NumberedList=RTE.PublishingRichTextEditorComponentProvider.$m;this.$0_1.TableContextualGroup=RTE.PublishingRichTextEditorComponentProvider.$X;this.$0_1.TableDesignTab=RTE.PublishingRichTextEditorComponentProvider.$11;this.$0_1.InsertTableMenu=RTE.PublishingRichTextEditorComponentProvider.$X;this.$0_1.TextStyle=RTE.PublishingRichTextEditorComponentProvider.$N;this.$0_1.TextStylePreview=RTE.PublishingRichTextEditorComponentProvider.$N;this.$0_1.TextStylePreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$N;this.$0_1.SelectTextStyle=RTE.PublishingRichTextEditorComponentProvider.$o;this.$0_1.SelectTextStyleOpen=RTE.PublishingRichTextEditorComponentProvider.$o;this.$0_1.SelectFontColor=RTE.PublishingRichTextEditorComponentProvider.$4;this.$0_1.SelectFontColorOpen=RTE.PublishingRichTextEditorComponentProvider.$4;this.$0_1.SelectBackgroundColor=RTE.PublishingRichTextEditorComponentProvider.$4;this.$0_1.SelectBackgroundColorOpen=RTE.PublishingRichTextEditorComponentProvider.$4;this.$0_1.ColorCssClass=RTE.PublishingRichTextEditorComponentProvider.$8;this.$0_1.ColorCssClassPreview=RTE.PublishingRichTextEditorComponentProvider.$8;this.$0_1.ColorCssClassPreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$8;this.$0_1.BackgroundColorCssClass=RTE.PublishingRichTextEditorComponentProvider.$8;this.$0_1.BackgroundColorCssClassPreview=RTE.PublishingRichTextEditorComponentProvider.$8;this.$0_1.BackgroundColorCssClassPreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$8;this.$0_1.ColorCustom=RTE.PublishingRichTextEditorComponentProvider.$g;this.$0_1.BackgroundColorCustom=RTE.PublishingRichTextEditorComponentProvider.$g;this.$0_1.ColorThemeClass=RTE.PublishingRichTextEditorComponentProvider.$9;this.$0_1.ColorThemeClassPreview=RTE.PublishingRichTextEditorComponentProvider.$9;this.$0_1.ColorThemeClassPreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$9;this.$0_1.BackgroundColorThemeClass=RTE.PublishingRichTextEditorComponentProvider.$9;this.$0_1.BackgroundColorThemeClassPreview=RTE.PublishingRichTextEditorComponentProvider.$9;this.$0_1.BackgroundColorThemeClassPreviewRevert=RTE.PublishingRichTextEditorComponentProvider.$9;this.$0_1.AlignLeft=RTE.PublishingRichTextEditorComponentProvider.$7;this.$0_1.AlignCenter=RTE.PublishingRichTextEditorComponentProvider.$7;this.$0_1.AlignRight=RTE.PublishingRichTextEditorComponentProvider.$7;this.$0_1.AlignJustify=RTE.PublishingRichTextEditorComponentProvider.$7;this.$0_1.DecreaseIndent=RTE.PublishingRichTextEditorComponentProvider.$7;this.$0_1.IncreaseIndent=RTE.PublishingRichTextEditorComponentProvider.$7;this.$0_1.Bold=RTE.PublishingRichTextEditorComponentProvider.$5;this.$0_1.Italics=RTE.PublishingRichTextEditorComponentProvider.$5;this.$0_1.Subscript=RTE.PublishingRichTextEditorComponentProvider.$5;this.$0_1.Superscript=RTE.PublishingRichTextEditorComponentProvider.$5;this.$0_1.Underline=RTE.PublishingRichTextEditorComponentProvider.$5;this.$0_1.StrikeThrough=RTE.PublishingRichTextEditorComponentProvider.$5;this.$0_1.EmbedGroup=RTE.PublishingRichTextEditorComponentProvider.$h;this.$0_1.InsertEmbedding=RTE.PublishingRichTextEditorComponentProvider.$h},getFocusedCommands:function(){ULS7Bo:;if(this.$2_1){var b=this.$2_1.getFocusedCommands(),a=[];Array.addRange(a,this.$E_1);Array.addRange(a,b);return a}return this.$E_1},getGlobalCommands:function(){ULS7Bo:;return this.$2_1?this.$2_1.getGlobalCommands():null},handleCommand:function(a,c,d){ULS7Bo:;if(!a)return false;this.initializeCommandHandlerDictionary();var b=this.$1_1[a];if(!RTE.PSU.$A(b)){var e=b;return e(a,c,d)}else if(this.$2_1)return this.$2_1.handleCommand(a,c,d);return false},initializeCommandHandlerDictionary:function(){ULS7Bo:;if(!RTE.PSU.$A(this.$1_1))return;this.$1_1={};this.$1_1.GetReusableContentMenuXml=RTE.PublishingRichTextEditorComponentProvider.$1G;this.$1_1.ReusableMenu=RTE.PublishingRichTextEditorComponentProvider.$1H;this.$1_1.ReusableMenuClose=RTE.PublishingRichTextEditorComponentProvider.$1F;this.$1_1.GetSocialPluginMenuXml=RTE.PublishingRichTextEditorComponentProvider.$1J;this.$1_1.LinkEditSharepoint=RTE.PublishingRichTextEditorComponentProvider.$p;this.$1_1.InsertLinkSharepoint=RTE.PublishingRichTextEditorComponentProvider.$p;this.$1_1.InsertImageSharepoint=RTE.PublishingRichTextEditorComponentProvider.$a;this.$1_1.InsertImage=RTE.PublishingRichTextEditorComponentProvider.$a;this.$1_1.ImageEdit=RTE.PublishingRichTextEditorComponentProvider.$a;this.$1_1.ImageSrc=this.$$d_$16_1;this.$1_1.QueryImageSrc=this.$$d_$1A_1;this.$1_1.GetImageRenditionsMenuXml=RTE.PublishingRichTextEditorComponentProvider.$15;this.$1_1.PickImageRenditionClick=RTE.PublishingRichTextEditorComponentProvider.$12;this.$1_1.EditImageRenditionClick=RTE.PublishingRichTextEditorComponentProvider.$13;this.$1_1.ImageHorizontalSpace=RTE.PublishingRichTextEditorComponentProvider.$14;this.$1_1.ImageVerticalSpace=RTE.PublishingRichTextEditorComponentProvider.$17;this.$1_1.QueryImageHorizontalSpace=RTE.PublishingRichTextEditorComponentProvider.$19;this.$1_1.QueryImageVerticalSpace=RTE.PublishingRichTextEditorComponentProvider.$1B;this.$1_1.LinkBookmark=RTE.PublishingRichTextEditorComponentProvider.$18;this.$1_1.QueryLinkBookmark=RTE.PublishingRichTextEditorComponentProvider.$1C;this.$1_1.ReusableItemClick=RTE.PublishingRichTextEditorComponentProvider.$Z;this.$1_1.ReusableItemPreview=RTE.PublishingRichTextEditorComponentProvider.$Z;this.$1_1.ReusableItemRevert=RTE.PublishingRichTextEditorComponentProvider.$Z;this.$1_1.ReusablePopup=RTE.PublishingRichTextEditorComponentProvider.$1I;this.$1_1.RcaOpenSource=RTE.PublishingRichTextEditorComponentProvider.$1D;this.$1_1.RcaUpdateDocument=RTE.PublishingRichTextEditorComponentProvider.$1E},$1A_1:function(e,a,c){ULS7Bo:;var d=this.$2_1.handleCommand(e,a,c),b=a.Value;if(b){a.Value=RTE.ImageRenditionCommands.addRenditionInfoToImageSrc(b);a.Value!==b&&this.$2_1.handleCommand("ImageSrc",a,c)}return d},$16_1:function(c,a,d){ULS7Bo:;var b=a.Value;a.Value=RTE.ImageRenditionCommands.addRenditionInfoToImageSrc(b);return this.$2_1.handleCommand(c,a,d)},isFocusable:function(){ULS7Bo:;return this.$2_1?this.$2_1.isFocusable():true},receiveFocus:function(){ULS7Bo:;return this.$2_1?this.$2_1.receiveFocus():true},yieldFocus:function(){ULS7Bo:;return this.$2_1?this.$2_1.yieldFocus():true}};RTE.ReusableContent=function(){};RTE.ReusableContent.getEditableRegionStorageHtml=function(c){ULS7Bo:;RTE.RteUtility.assertNotNull("editableRegion",c);var a=[];RTE.ReusableContent.$r(c,a);var b=new Sys.StringBuilder;if(a.length>0){b.append('<div id="__publishingReusableFragmentIdSection">');for(var d=0;d<a.length;d++){var f=a[d];b.append('<a href="'+f+'">a</a>')}b.append("</div>")}RTE.CanvasEvents.registerListener("ElementGenerateTag",RTE.ReusableContent.$b);var e=b.toString()+RTE.Canvas.getEditableRegionHtml(c,true);RTE.CanvasEvents.unRegisterListener("ElementGenerateTag",RTE.ReusableContent.$b);return e};RTE.ReusableContent.$r=function(c,f){ULS7Bo:;for(var d=c.childNodes,b=0;b<d.length;b++){var a=d[b];if(!a)continue;if(a.id==="__publishingReusableFragment"){var e=RTE.RteUtility.getAttribute(a,"fragmentid");if(e)f.push(e);else{while(a.childNodes.length>0)c.insertBefore(a.childNodes[0],a);c.removeChild(a);continue}a.className="ms-reusableTextView ms-rtegenerate-notify"}else RTE.ReusableContent.$r(a,f)}};RTE.ReusableContent.$1K=function(d,b){ULS7Bo:;var a=b.node;if(a.id==="__publishingReusableFragment"){var c=b.html;c.append('<SPAN ID="__publishingReusableFragment"></SPAN>');a.className="ms-reusableTextView"}};RTE.ReusableContent.insertReusableItem=function(b){ULS7Bo:;if(!b)return;var c=RTE.Cursor.get_range();c.deleteContent();var a=document.createElement("SPAN");a.innerHTML=b.html;if(b.automaticUpdate==="True"){a.setAttribute("fragmentid",b.id);a.id="__publishingReusableFragment";a.className="ms-reusableTextView";RTE.Canvas.makeRegionUnEditable(a)}c.insertBefore(a);RTE.Cursor.update()};RTE.ReusableContent.insertReusableItemFromDialog=function(){ULS7Bo:;var c=null,b=RTE.Cursor.getSelectedAtomic();if(b&&b.id==="__publishingReusableFragment")c=RTE.RteUtility.getAttribute(b,"fragmentid");var d={};d.fragmentId=c;var e=RTE.Cursor.get_range().getEditableRegion(),a=RTE.Canvas.getProperty(e,"ServerRelativeUrl");if(a.lastIndexOf("/")+1!==a.length)a+="/";var f=a+SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+"ReusableTextPicker.aspx";RTE.Common.showModalDialog(f,"dialogHeight:600px; dialogWidth:800px; center:yes; resizable:yes; scroll:no; status:no;",RTE.ReusableContent.$1Q,d)};RTE.ReusableContent.$1Q=function(a){ULS7Bo:;if(!a)return;var b=a.fragmentView;RTE.Cursor.get_range().deleteContent();RTE.Cursor.get_range().replaceHtml(b);RTE.Cursor.get_range().collapse(false);RTE.Cursor.update()};RTE.PSU=function(){};RTE.PSU.$G=function(a){ULS7Bo:;var b=null;return a===b||typeof a==="undefined"||!a.length};RTE.PSU.$A=function(a){ULS7Bo:;var b=null;return a===b||typeof a==="undefined"};RTE.Rca=function(){};RTE.Rca.updateFromSourceDocument=function(){ULS7Bo:;if(!RTE.Externals.rca.enabled)return;if(confirm(RTE.Externals.rca.updateFromSourceMessage))eval(RTE.Externals.rca.updateFromSourceFn)};RTE.Rca.$1L=function(b){ULS7Bo:;var a=new RegExp("/^.*\\.([^\\.]*)$/");return b.replace(a,"$1").toLowerCase()};RTE.Rca.openSourceDocument=function(){ULS7Bo:;if(!RTE.Externals.rca.enabled)return;if(!RTE.Externals.rca.intranetMode)window.open(RTE.Externals.rca.sourceDocumentUrl);else{var a;try{if(RTE.Rca.$1L(RTE.Externals.rca.sourceDocumentUrl)==="xml")a=new ActiveXObject("SharePoint.OpenXMLDocuments");else a=new ActiveXObject("SharePoint.OpenDocuments.2")}catch(b){window.open(RTE.Externals.rca.sourceDocumentUrl);return}a&&a.EditDocument2(window.self,RTE.Externals.rca.sourceDocumentUrl,RTE.Externals.rca.sourceDocumentProgId)}};RTE.ImageRenditionCommands=function(){};RTE.ImageRenditionCommands.getSourceUrlOnly=function(a){ULS7Bo:;var c=RTE.ImageRenditionCommands.$P();if(!RTE.ImageRenditionCommands.$c(c))return a;var b=RTE.ImageUrlWithRendition.$R(a);return!b?a:b.get_sourceUrl()};RTE.ImageRenditionCommands.addRenditionInfoToImageSrc=function(c){ULS7Bo:;var a=RTE.ImageRenditionCommands.$P();if(!RTE.ImageRenditionCommands.$c(a))return c;var b=RTE.ImageUrlWithRendition.$R(c);if(!b)return c;try{if(a.RenditionId&&a.RenditionId.length>0){var d=Number.parseInvariant(a.RenditionId);d>=0&&b.set_renditionId(d)}if(a.DisplayWidth&&a.DisplayWidth.length>0){var e=Number.parseInvariant(a.DisplayWidth);e>=0&&b.set_width(e)}if(a.DisplayHeight&&a.DisplayHeight.length>0){var f=Number.parseInvariant(a.DisplayHeight);f>=0&&b.set_height(f)}}catch(g){return c}return b.get_completeUrl()};RTE.ImageRenditionCommands.editImageRenditions=function(){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(a){var c=RTE.ImageUrlWithRendition.$R(a.src);if(c){var b=new SP.UI.DialogOptions,d="?ImageUrl="+SP.Utilities.HttpUtility.urlKeyValueEncode(RTE.RteUtility.getServerRelativeUrl(c.get_sourceUrl()));b.url=SP.Utilities.UrlBuilder.urlCombine(SP.PageContextInfo.get_webServerRelativeUrl(),SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+"ManageImageRenditions.aspx")+d;b.autoSize=true;b.allowMaximize=true;b.dialogReturnValueCallback=function(){ULS7Bo:;var b=a.src;if(b.indexOf("?")>0){var c=a.cloneNode(true);SP.UI.UIUtility.insertAfter(c,a);SP.UI.UIUtility.removeNode(a);RTE.RteUtility.isClassAvailable("SP.UI.Notify")&&SP.UI.Notify.addNotification(SP.Publishing.Resources.imageRenditionChangeWarning,false);RTE.Cursor.update()}};SP.UI.ModalDialog.showModalDialog(b)}}};RTE.ImageRenditionCommands.changeImageRendition=function(e){ULS7Bo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(a){var b=RTE.ImageUrlWithRendition.$R(a.src);if(b){b.set_renditionId(e);var c=b.get_completeUrl();if(c!==a.src){RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirty();a.style.height="";a.style.width="";a.removeAttribute("width");a.removeAttribute("height");RTE.CanvasEvents.resetImageSizes(a);a.src=c;var d=RTE.ImageRenditionCommands.$P();!d&&RTE.RteUtility.initImageSizeForce(a);RTE.SnapshotManager.takeSnapshot();RTE.PublishingRichTextEditor.$u()}}}};RTE.ImageRenditionCommands.canChangeRendition=function(){ULS7Bo:;var a=RTE.ImageRenditionCommands.$P();if(RTE.ImageRenditionCommands.$c(a)&&a.RenditionId&&a.RenditionId.length>0&&Number.parseInvariant(a.RenditionId)>=0)return false;var b=RTE.CanvasEvents.getNodeFromEvent("Image");return!b?false:RTE.ImageRenditionCommands.$1S(b.src)};RTE.ImageRenditionCommands.$1S=function(b){ULS7Bo:;var e=b.indexOf("?");if(e>0)b=b.substr(0,e);var c=RTE.ImageRenditionCommands.$F[b];if(typeof c==="boolean")return c;if(!RTE.ImageRenditionCommands.$1R(b)){RTE.ImageRenditionCommands.$F[b]=false;return false}var a=new XMLHttpRequest,d=SP.PageContextInfo.get_webServerRelativeUrl();if(!d.startsWith("/"))d="/"+d;a.open("POST",SP.Utilities.UrlBuilder.urlCombine(encodeURI(d),"_vti_bin/sites.asmx"),true);a.onreadystatechange=function(){ULS7Bo:;if(a.readyState===4)if(a.status===200&&a.responseXML){try{var d=RTE.ImageRenditionCommands.$1M(a.responseXML);c=SP.PageContextInfo.get_siteAbsoluteUrl().toUpperCase()===d.toUpperCase();RTE.ImageRenditionCommands.$F[b]=c}catch(e){c=false}c&&RTE.PublishingRichTextEditor.$u()}};a.setRequestHeader("Content-Type","text/xml; charset=utf-8");a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetSite");var f='<?xml version="1.0" encoding="utf-8"?>\r\n                    <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"\r\n                        xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\r\n                        <soap:Body>\r\n                            <GetSite xmlns="http://schemas.microsoft.com/sharepoint/soap/">\r\n                                <SiteUrl>'+RTE.RteUtility.htmlEncode(b)+"</SiteUrl>\r\n                            </GetSite>\r\n                        </soap:Body>\r\n                    </soap:Envelope>";a.send(f);RTE.ImageRenditionCommands.$F[b]=false;return false};RTE.ImageRenditionCommands.$1M=function(d){ULS7Bo:;var a=d;while(a.lastChild)a=a.lastChild;var b=a.nodeValue,c=Sys.Net.XMLDOM(b);return c.lastChild.attributes.getNamedItem("Url").nodeValue};RTE.ImageRenditionCommands.$1R=function(c){ULS7Bo:;var b=c.indexOf("://");if(b>0){var d=c.indexOf("/",b+3);if(d>0){var a=c.substring(b+3,d),e=window.location.hostname.toLowerCase();a=a.toLowerCase();return a===e||a===e+":"+window.location.port}}return false};RTE.ImageRenditionCommands.$c=function(a){ULS7Bo:;return!!a&&(!!a.RenditionId||!!a.DisplayWidth||!!a.DisplayHeight)};RTE.ImageRenditionCommands.$P=function(){ULS7Bo:;if(typeof GetAssetSelector!=="function")return null;var c=RTE.Canvas.currentEditableRegion();if(!c)return null;var a=c.getAttribute("AssetID");if(!a||!a.length)return null;var b=GetAssetSelector(a);return!b||!b.Config?null:b.Config};RTE.ImageUrlWithRendition=function(a,b){ULS7Bo:;this.$S_0=a;this.$B_0=b};RTE.ImageUrlWithRendition.$s=function(a){ULS7Bo:;a=a.toUpperCase();return a==="RenditionID".toUpperCase()?"RenditionID":a==="Width".toUpperCase()?"Width":a==="Height".toUpperCase()?"Height":a};RTE.ImageUrlWithRendition.$R=function(a){ULS7Bo:;if(!a)return null;var b=a.indexOf("?"),c=b>0?a.substr(b):null,d=RTE.ImageUrlWithRendition.$1T(c);if(b>0)a=a.substring(0,b);return new RTE.ImageUrlWithRendition(a,d)};RTE.ImageUrlWithRendition.$1T=function(a){ULS7Bo:;var d={};if(a&&a.length>1){a=a.substr(1);for(var e=a.split("&"),b=0;b<e.length;b++){var c=e[b].split("="),f=RTE.ImageUrlWithRendition.$s(c[0]);d[f]=c.length>1?c[1]:f}}return d};RTE.ImageUrlWithRendition.prototype={$S_0:null,$B_0:null,get_sourceUrl:function(){ULS7Bo:;return this.$f_0(false)},get_completeUrl:function(){ULS7Bo:;return this.$f_0(true)},get_renditionId:function(){ULS7Bo:;return this.$d_0("RenditionID",-1)},set_renditionId:function(a){ULS7Bo:;this.$e_0("RenditionID",-1,a);return a},get_width:function(){ULS7Bo:;return this.$d_0("Width",0)},set_width:function(a){ULS7Bo:;this.$e_0("Width",0,a);return a},get_height:function(){ULS7Bo:;return this.$d_0("Height",0)},set_height:function(a){ULS7Bo:;this.$e_0("Height",0,a);return a},$e_0:function(a,c,b){ULS7Bo:;if(b>c)this.$B_0[a]=b.toString();else delete this.$B_0[a]},$d_0:function(b,c){ULS7Bo:;var a=this.$B_0[b];if(a&&a.length>0)try{return Number.parseInvariant(a)}catch(d){}return c},$f_0:function(g){ULS7Bo:;var a="",f=true,d=this.$B_0;for(var e in d){var c={key:e,value:d[e]};if(!c.value)continue;var b=RTE.ImageUrlWithRendition.$s(c.key);if(g||!(b==="RenditionID"||b==="Width"||b==="Height")){a+=f?"?":"&";a+=b;a+="=";a+=c.value;f=false}}return this.$S_0+a}};RTE.PublishingCanvas.registerClass("RTE.PublishingCanvas",RTE.Canvas);RTE.PublishingCommandNames.registerClass("RTE.PublishingCommandNames");RTE.PublishingRibbonIds.registerClass("RTE.PublishingRibbonIds");RTE.PublishingRichTextEditor.registerClass("RTE.PublishingRichTextEditor",RTE.RichTextEditor);RTE.PublishingRichTextEditorComponentProvider.registerClass("RTE.PublishingRichTextEditorComponentProvider",RTE.RichTextEditorComponentProvider);RTE.ReusableContent.registerClass("RTE.ReusableContent");RTE.PSU.registerClass("RTE.PSU");RTE.Rca.registerClass("RTE.Rca");RTE.ImageRenditionCommands.registerClass("RTE.ImageRenditionCommands");RTE.ImageUrlWithRendition.registerClass("RTE.ImageUrlWithRendition");function sp_ui_rte_publishing_initialize(){ULS7Bo:;RTE.PublishingCommandNames.insertLinkSharepoint="InsertLinkSharepoint";RTE.PublishingCommandNames.insertImageSharepoint="InsertImageSharepoint";RTE.PublishingCommandNames.imageHorizontalSpace="ImageHorizontalSpace";RTE.PublishingCommandNames.imageVerticalSpace="ImageVerticalSpace";RTE.PublishingCommandNames.linkBookmark="LinkBookmark";RTE.PublishingCommandNames.linkDisplayIcon="LinkDisplayIcon";RTE.PublishingCommandNames.reusableDialog="ReusablePopup";RTE.PublishingCommandNames.reusableItemAction="ReusableItem";RTE.PublishingCommandNames.reusableItem="ReusableItemClick";RTE.PublishingCommandNames.reusableItemPreview="ReusableItemPreview";RTE.PublishingCommandNames.reusableItemPreviewRevert="ReusableItemRevert";RTE.PublishingCommandNames.spellchecking="Spellcheck";RTE.PublishingCommandNames.spellcheckingReview="ReviewSpellcheck";RTE.PublishingCommandNames.spellcheckingItemPreviewRevert="ItemPreviewRevertSpellchecking";RTE.PublishingCommandNames.noSpellchecking="NoSpellchecking";RTE.PublishingCommandNames.noSpellcheckingReview="ReviewNoSpellchecking";RTE.PublishingCommandNames.noSpellcheckingItemPreviewRevert="ItemPreviewRevertNoSpellchecking";RTE.PublishingCommandNames.queryImageHorizontalSpace="QueryImageHorizontalSpace";RTE.PublishingCommandNames.queryImageVerticalSpace="QueryImageVerticalSpace";RTE.PublishingCommandNames.rcaOpenSource="RcaOpenSource";RTE.PublishingCommandNames.rcaUpdateDocument="RcaUpdateDocument";RTE.PublishingCommandNames.linkEditSharepoint="LinkEditSharepoint";RTE.PublishingCommandNames.pickImageRendition="PickImageRendition";RTE.PublishingCommandNames.pickImageRenditionClick="PickImageRenditionClick";RTE.PublishingCommandNames.editImageRenditionClick="EditImageRenditionClick";RTE.PublishingRibbonIds.reusableItem="fseaReusableItem";RTE.PublishingRichTextEditor.$O=false;RTE.PublishingRichTextEditor.$I=false;RTE.PublishingRichTextEditorComponentProvider.$H=-1;RTE.ReusableContent.$b=RTE.ReusableContent.$1K;RTE.ImageRenditionCommands.$F={}}sp_ui_rte_publishing_initialize();RTE.ReusableItems=function(){};if(typeof reusableContent!="undefined")RTE.ReusableItems.items=reusableContent;RTE.Common=function(){};RTE.Common.showModalDialog=commonShowModalDialog;function InsertOrChangeImage(j,e,d,g,f,c,i){ULS7Bo:;var a=document.getElementById("ms-rteinput-image");a&&a.parentNode.removeChild(a);a=document.createElement("INPUT");a.id="ms-rteinput-image";a.value=c.src;a.type="hidden";document.body.appendChild(a);var b=new AssetPickerConfig("");b.ClientID=j;b.DefaultAssetLocation=e;b.DefaultAssetImageLocation=d;b.CurrentWebBaseUrl=g;b.AllowExternalUrls=f;b.ManageHyperlink=false;b.AssetUrlClientID=a.id;b.ReturnCallback=function(f,e,d,b){ULS7Bo:;c.src=a.value;document.body.removeChild(a);i(f,e,d,b)};var h=new ImageAsset(c.src);h.LaunchModalAssetPicker(b)}RTE.Common.insertOrChangeImage=InsertOrChangeImage;function InsertOrChangeHyperLink(j,f,e,h,g,c,i){ULS7Bo:;var a=document.getElementById("ms-rteinput-link");a&&a.parentNode.removeChild(a);a=document.createElement("INPUT");a.id="ms-rteinput-link";a.value=c.href;a.type="hidden";document.body.appendChild(a);var b=new AssetPickerConfig("");b.ClientID=j;b.DefaultAssetLocation=f;b.DefaultAssetImageLocation=e;b.CurrentWebBaseUrl=h;b.AllowExternalUrls=g;b.AssetUrlClientID=a.id;b.ReturnCallback=function(f,e,d,b){ULS7Bo:;c.href=a.value;document.body.removeChild(a);i(f,e,d,b)};var d=new LinkAsset(c.href);d.ManageLinkDisplayText=false;d.LaunchModalAssetPicker(b)}RTE.Common.insertOrChangeHyperLink=InsertOrChangeHyperLink;ExecuteAndRegisterBeginEndFunctions("sp.ui.rte.publishing.js",sp_ui_rte_publishing_initialize,null,function(){ULS7Bo:;RTE.Externals=function(){};if(typeof rca!="undefined")RTE.Externals.rca=rca;if(typeof imageRenditions!="undefined")RTE.Externals.imageRenditions=imageRenditions;ExecuteOrDelayUntilScriptLoaded(RTE.PublishingCanvas.loadPublishing,"sp.ui.rte.js")});NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.rte.publishing.js");typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_sp.ui.rte.publishing.js");